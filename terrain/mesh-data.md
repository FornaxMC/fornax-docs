# 概述

所有地形网格都会储存到一个统一的缓冲区（buffer object）中，方便合批（batching）和可见性缓冲区（visibility buffer）着色。顶点数据以一个四边形面存储和索引（indexing）。四边形面以一个区块里的一个渲染层（render layer）组成一块存储在缓冲区里。

## 索引

每个四边形面都有一个单独的ID，可以作为索引从属性索引缓冲区（attribute index buffer）获取属性索引，然后使用属性索引获取实际顶点属性数据。由于一个区块网格的四边形面是连续存储的，所以一个绘制批次（draw batch）的元数据可以只存储第一个四边形面的ID还有批次里的四边形面总数。考虑到MC地形网格数据的特性，使用了两个索引获取属性，一个获取位置，一个获取剩下的如纹理坐标等属性，这样能最大化索引压缩的效果。

注意：虽然纹理坐标和其它位置以外的属性使用了同一个索引，但是它们是分开存储的。因为几何绘制阶段不需要位置和纹理坐标以外的数据，所以可以分开存储以提高缓存命中率。

## 顶点数据格式

顶点数据以4个顶点为单位交错存储一个类型的属性，方便读取和插值。比如四边形1，2，3，.......；顶点A，B，C，D；以及坐标（或者其它属性）x，y，z，它们按照以下方式排列：

```1Ax 1Bx 1Cx 1Dx  1Ay 1By 1Cy 1Dy  1Az 1Bz 1Cz 1Dz  2Ax 2Bx 2Cx 2Dx  2Ay 2By 2Cy 2Dy  2Az 2Bz 2Cz 2Dz ...`
